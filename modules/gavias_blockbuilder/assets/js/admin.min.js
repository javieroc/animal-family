!function(a){function b(b,e){this.element=b,this.options=a.extend({},d,e),this._defaults=d,this._name=c}var c="serializeObject",d={requiredFormat:{}};b.prototype.toJsonObject=function(){var b=this,c=b.replaceEmptyBracketWithNumericBracket(a(b.element).serializeArray()),d=b.options.requiredFormat;return a.each(c,function(c,e){var f=e.name.replace(/]/g,"").split("["),g=b.stringArrayKeyToVariable(f,e.value);d=a.extend(!0,{},d,g)}),d},b.prototype.replaceEmptyBracketWithNumericBracket=function(b){var c={},d=b;return a.each(d,function(a,b){var e=b.name,f=e.indexOf("[]");f>-1&&(c[e]="undefined"==typeof c[e]?0:++c[e],d[a].name=b.name.replace("[]","["+c[e]+"]"))}),d},b.prototype.stringArrayKeyToVariable=function(a,b){var c,d=this;if(a.length>0){var e=a.shift().trim();c=isNaN(e)&&""!=e?{}:[],c[e]=a.length>0?d.stringArrayKeyToVariable(a,b):b}return c},a.fn[c]=function(a){return new b(this,a).toJsonObject()}}(jQuery,window,document);var keyString="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";base64Encode=function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=UTF8Encode(a);j<a.length;)b=a.charCodeAt(j++),c=a.charCodeAt(j++),d=a.charCodeAt(j++),e=b>>2,f=(3&b)<<4|c>>4,g=(15&c)<<2|d>>6,h=63&d,isNaN(c)?g=h=64:isNaN(d)&&(h=64),i=i+keyString.charAt(e)+keyString.charAt(f)+keyString.charAt(g)+keyString.charAt(h);return i},UTF8Encode=function(a){a=a.replace(/\x0d\x0a/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},GaviasCompare=function(a,b){return a.index<b.index?-1:a.index>b.index?1:0},function(a){function b(b,c){a.notify({title:"Notification",text:c,image:'<i class="fa fa-bell" style="font-size: 30px; color: #fff;"></i>',hideAnimation:"slideUp"},{style:"metro",className:b,autoHide:!1,clickToHide:!0,globalPosition:"top center"})}function c(){var c=a("#gavias-blockbuilder-setting").serializeObject();c=a.extend({},c),c=base64Encode(JSON.stringify(c));var d=a("input[name=gavias_blockbuilder_id]").val(),e={data:c,pid:d};b("info","Please waiting Block Builder process !"),a.ajax({url:Drupal.settings.basePath+"?q=admin/gavias_blockbuilder/save",type:"POST",data:e,dataType:"json",success:function(c){a("#save").val("Save"),b("success","Block Builder setting updated"),window.location=gbb_url_redirect},error:function(a,c,d){alert(c+":"+a.responseText),b("black","Block Builder setting not updated")}})}function d(a,b,c){return a.find(b).sortable({start:function(a,b){b.placeholder.width(b.item.find(".gavias-blockbuilder-content").first().width()-20),b.placeholder.height(b.item.height()-20)},connectWith:b,cursor:"move",forcePlaceholderSize:!0,placeholder:"gbb-placeholder",items:c,opacity:1,receive:function(a,b){var c=jQuery(this).siblings(".gbb-row-id").val();b.item.find(".element-parent").val(c)}}),a}function e(){var b=a("#gbb-admin-wrap");b.find(".gbb-droppable-column").sortable({start:function(a,b){b.placeholder.width(120),b.item.width(120),b.placeholder.height(b.item.height()-20)},connectWith:".gbb-droppable-column",cursor:"move",forcePlaceholderSize:!0,placeholder:"gbb-placeholder",items:".gbb-item",opacity:.9,receive:function(a,b){var c=jQuery(this).siblings(".gbb-column-id").val(),d=jQuery(this).parents(".gbb-row").find(".gbb-row-id").val();b.item.find(".element-parent").val(c),b.item.find(".element-row-parent").val(d)}})}function f(){var b=a("#gbb-admin-wrap"),c=0;b.find(".gbb-droppable-row").sortable({start:function(a,b){b.placeholder.width(b.item.find(".gavias-blockbuilder-content").first().width()-20),b.placeholder.height(b.item.height()-20)},connectWith:".gbb-droppable-row",cursor:"move",forcePlaceholderSize:!0,placeholder:"gbb-placeholder",items:".gbb-columns",opacity:.9,receive:function(a,b){var c=jQuery(this).siblings(".gbb-row-id").val();b.item.find(".column-parent").val(c),b.item.find(".element-row-parent").val(c)},update:function(){b.find(".gbb-row").each(function(){c=0,a(this).find(".gbb-columns").each(function(){c++,a(this).find("input.gbb-column-id").val(c),a(this).find("input.element-parent").val(c)})})}})}function g(b,c,d){var g=(a("#gbb-admin-wrap"),a("#gbb-columns .gbb-columns").clone(!0));g.hide();var h=b.parents(".gbb-row").find(".gbb-row-id").val(),i=-1,j=c;g.removeClass("wb-4").addClass("wb-"+j),g.find("input.column-size").val(j),g.find("item-w-label").html(j),b.parents(".gbb-row").find("input.gbb-column-id").each(function(){a(this).val()>i&&(i=a(this).val())}),-1==i&&(i=0),a("#gbb-column-id").val(1*a("#gbb-column-id").val()+1),g.addClass("type-"+d),g.find(".item-w-label").html(j),g.find(".gbb-column-id").val(1*i+1),g.find("input.column-parent").val(h),g.find("input.column-type").val(d),b.parents(".gbb-row").find(".gbb-droppable-row").append(g).find(".gbb-columns").fadeIn(500),e(),f()}function h(){var b=a("#gbb-admin-wrap"),c=".gbb-sortable",h=".gbb-item",i="#gbb-items";if(!b.length)return!1;b.sortable({start:function(a,b){b.placeholder.width(b.item.find(".gavias-blockbuilder-content").first().width()-20),b.placeholder.height(b.item.height()-20)},cursor:"move",forcePlaceholderSize:!0,placeholder:"gbb-placeholder",items:".gbb-row",opacity:.9}),f(),e(),a(".gbb-plus").click(function(){for(var b=a(this).closest(".gbb-columns"),c=["1","2","3","4","5","6","7","8","9","10","11","12"],d=0;d<c.length-1;d++){var e="wb-"+c[d].replace("/","-"),f="wb-"+c[d+1].replace("/","-");if(b.hasClass(e)){b.removeClass(e).addClass(f).find(".column-size").val(c[d+1]),b.find(".item-w-label").text(c[d+1]);break}}}),a(".gbb-minus").click(function(){for(var b=a(this).closest(".gbb-columns"),c=["1","2","3","4","5","6","7","8","9","10","11","12"],d=1;d<c.length;d++){var e="wb-"+c[d].replace("/","-"),f="wb-"+c[d-1].replace("/","-");if(b.hasClass(e)){b.removeClass(e).addClass(f).find(".column-size").val(c[d-1]),b.find(".item-w-label").text(c[d-1]);break}}});var j=a("#gbb-row-id");a(".bb-btn-row-add").click(function(){var e=a("#gbb-rows .gbb-row").clone(!0);d(e,c,h),e.hide().find(".gavias-blockbuilder-content > input").each(function(){a(this).attr("name",a(this).attr("class")+"[]")}),j.val(1*j.val()+1),e.find(".gbb-row-id").val(j.val()),b.append(e).find(".gbb-row").fadeIn(500)}),a(".gbb-add-column").click(function(){var b=a(this).attr("data-width");g(a(this),b,"")}),a(".gbb-add-clear").click(function(){g(a(this),"12","column-clearfix")}),a(".gbb-row .gbb-row-clone").click(function(){var b=a(this).closest(".gbb-element");b.find(c).sortable("destroy");var d=b.clone(!0);j.val(1*j.val()+1),d.find(".gbb-row-id, .element-parent").val(j.val()),b.after(d),f(),e()}),a(".gbb-add").click(function(){var b=a(this).parent();b.hasClass("focus")?b.removeClass("focus"):(a(".gbb-add-element").removeClass("focus"),b.addClass("focus"))}),a(".gbb-items a").click(function(){a(this).closest(".gbb-add-element").removeClass("focus");var b=a(this).parents(".gbb-columns").find(".gbb-droppable"),c=a(this).parents(".gbb-columns").find(".gbb-column-id").val(),d=a(this).parents(".gbb-row").find(".gbb-row-id").val(),g=a(this).attr("class"),h=a(i).find("div.gbb-type-"+g).clone(!0);h.hide().find(".gavias-blockbuilder-content input").each(function(){a(this).attr("name",a(this).attr("class")+"[]")}),h.find(".element-parent").val(c),h.find(".element-row-parent").val(d),b.append(h).find(".gbb-item").fadeIn(500),e(),f()}),a(".gbb-el-delete").click(function(){var b=a(this).closest(".gbb-element");return confirm("You are sure delete this element ! Continue?")?void b.fadeOut(500,function(){a(this).remove()}):!1}),a(".gbb-column-delete").click(function(){var b=a(this).closest(".gbb-columns");return confirm("You are sure delete this column ! Continue?")?void b.fadeOut(500,function(){a(this).remove()}):!1}),a(".gbb-item .gbb-item-clone").click(function(){var b=a(this).closest(".gbb-element"),c=b.clone(!0);b.after(c)});var k="",l="";a(".gbb-edit").click(function(){l="",a("#gbb-form-setting").parent().find(".gavias-overlay").first().addClass("active").parents("body").addClass("gavias-overflow-hidden"),k=a(this).closest(".gbb-element");var b=k.children(".gbb-el-meta").clone(!0);l=k.children(".gbb-el-meta").clone(!0),a("#gbb-form-setting").prepend(b).fadeIn(350,function(){}),a("#gbb-form-setting .gbb-el-meta").animate({scrollTop:0},500),k.children(".gbb-el-meta").remove()}),a("#gbb-form-setting .gbb-form-setting-save").click(function(){a(".tabs-ul.ui-sortable").sortable("destroy");var b=a("#gbb-form-setting"),c=b.find(".gbb-el-meta").clone(!0);k.append(c),k.find(".item-bb-title").html(k.find(".display-admin").first().val()),b.fadeOut(50,function(){a(this).parent().find(".gavias-overlay").first().removeClass("active").parents("body").removeClass("gavias-overflow-hidden")}),setTimeout(function(){b.find(".gbb-el-meta").remove()},50),k="",l=""}),a("#gbb-form-setting .gbb-form-setting-cancel").click(function(){a(".tabs-ul.ui-sortable").sortable("destroy");var b=a("#gbb-form-setting");k.append(l),b.fadeOut(50).parent().find(".gavias-overlay").first().removeClass("active").parents("body").removeClass("gavias-overflow-hidden"),setTimeout(function(){b.find(".gbb-el-meta").remove()},50),k="",l=""})}a.fn.extend({insertcaret:function(a){return this.each(function(){if(document.selection){this.focus();var b=document.selection.createRange();b.text=a,this.focus()}else if(this.selectionStart||"0"==this.selectionStart){var c=this.selectionStart,d=this.selectionEnd,e=this.scrollTop;this.value=this.value.substring(0,c)+a+this.value.substring(d,this.value.length),this.focus(),this.selectionStart=c+a.length,this.selectionEnd=c+a.length,this.scrollTop=e}else this.value+=a,this.focus()})}}),a(document).ready(function(){a("#save").click(function(){return c(),!1})}),function(a){jQuery.fn.clone=function(){for(var b=a.apply(this,arguments),c=this.find("textarea, select"),d=b.find("textarea, select"),e=0,f=c.length;f>e;++e)jQuery(d[e]).val(jQuery(c[e]).val());return b}}(jQuery.fn.clone),a(document).ready(function(){h()}),a(document).mouseup(function(b){0===a(".gbb-add-element").has(b.target).length&&a(".gbb-add-element").removeClass("focus"),0===a(".gbb-sc-add").has(b.target).length&&a(".gbb-sc-add").removeClass("focus")}),a(document).ready(function(){a(".gavias-add-quick-shortcode").click(function(){var b=a(this).parents(".textarea-wrapper.gerenal_sc").find(".list-shortcodes").first().val();if(b){var c=$general_shortcodes[b],d=a(this).parents(".textarea-wrapper.gerenal_sc").find("textarea");d.insertcaret(c)}})})}(jQuery);